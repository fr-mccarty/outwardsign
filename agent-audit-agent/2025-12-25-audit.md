# Agent Ecosystem Audit - 2025-12-25

## Executive Summary

**Overall Health: GOOD** - The agent ecosystem is well-structured with clear boundaries and comprehensive coverage. This is the first audit, establishing a baseline for future improvements.

**Key Findings:**
- **Critical:** 1 issue (settings.local.json exists)
- **High:** 2 issues (missing agents, hook gaps)
- **Medium:** 4 issues (documentation drift, structural inconsistencies)
- **Low:** 3 issues (minor improvements)

**Strengths:**
- Excellent agent boundaries with clear "You do NOT" statements
- Comprehensive hook coverage for critical operations
- Strong creep resistance patterns (anchoring, scope limiters)
- Well-documented workflow in AGENT_WORKFLOWS.md

---

## Critical Issues

### settings.local.json Exists

**Category:** Settings Hygiene
**Finding:** `/Users/joshmccarty/Code-2022M1/outwardsign/.claude/settings.local.json` exists
**Impact:** Settings should only live in `settings.json` per CLAUDE.md. Local settings create configuration drift and are not version-controlled.
**Recommendation:**
1. Review contents of settings.local.json for any valuable configuration
2. Merge any necessary settings into settings.json
3. Delete settings.local.json
4. Add to .gitignore if not already present

---

## High Priority Issues

### Missing Agent: wisdom-agent

**Category:** Agent Boundaries
**Finding:** AGENT_WORKFLOWS.md (line 59) lists `wisdom-agent` in the agent inventory but doesn't clearly define when to use it versus other "conversational" agents like brainstorming-agent or devils-advocate-agent.
**Impact:** Users may not know when to invoke wisdom-agent specifically.
**Recommendation:**
- wisdom-agent exists and has clear purpose ("when stuck, overwhelmed, or need perspective")
- But AGENT_WORKFLOWS.md decision tree (lines 144-145) could be more prominent
- Consider adding wisdom-agent examples to Quick Decision Guide at top of CLAUDE.md
- Actual finding: wisdom-agent is underutilized relative to its value - recommend promoting it more visibly

### Hook Coverage Gap: Pickers

**Category:** Hook Coverage
**Finding:** CLAUDE.md "Required Reading by Task" table (line 26) lists "Work with pickers → PICKERS.md" but there are no hooks for editing picker files
**Impact:** Developers may edit picker components without reviewing the documented patterns in PICKERS.md
**Recommendation:** Add PreToolUse hooks for:
```
Edit(src/components/pickers/*.tsx) → Prompt to read PICKERS.md
Write(src/components/pickers/*.tsx) → Prompt to read PICKERS.md
```

### Hook Coverage Gap: Validation

**Category:** Hook Coverage
**Finding:** CLAUDE.md table (line 30) lists "Add form validation → FORMS-CRITICAL.md, VALIDATION.md" but no hooks trigger when editing validation files
**Impact:** Validation patterns may diverge from documented standards
**Recommendation:** Add PreToolUse hooks for:
```
Edit(src/lib/validation/*.ts) → Prompt to read VALIDATION.md
Write(src/lib/validation/*.ts) → Prompt to read VALIDATION.md
```

---

## Medium Priority Issues

### Agent Count Mismatch

**Category:** Documentation Alignment
**Finding:**
- AGENT_WORKFLOWS.md line 40: "Complete Agent List (17 agents)"
- Actual count in .claude/agents/: 18 agents (brainstorming, devils-advocate, requirements, developer, test-writer, test-runner-debugger, project-documentation-writer, code-review, user-documentation-writer, explorer, refactor, qa-specialist, release, ui, ux, wisdom, supervisor, agent-audit)
**Impact:** Documentation doesn't match reality - minor confusion
**Recommendation:** Update AGENT_WORKFLOWS.md line 40 to reflect 18 agents

### brainstorming-agent Missing devils-advocate Handoff

**Category:** Agent Boundaries
**Finding:** brainstorming-agent.md line 23 says "Next Agent: requirements-agent" but AGENT_WORKFLOWS.md shows devils-advocate-agent should be step 1.5
**Impact:** brainstorming-agent doesn't mention handing off to devils-advocate-agent for review
**Recommendation:** Update brainstorming-agent.md to mention optional devils-advocate-agent review before moving to requirements

### Inconsistent Workflow Numbering

**Category:** Agent Structure
**Finding:** Agents use different workflow numbering schemes:
- Some say "Step 1 of 8" (brainstorming-agent)
- Some say "Step 1.5 of 9" (devils-advocate-agent)
- Some say "Step 2 of 8" (requirements-agent)
- This creates confusion about actual workflow length
**Impact:** Minor confusion about total steps and optional vs required agents
**Recommendation:** Standardize to:
- Core workflow: 7 steps (brainstorming → requirements → developer → test-writer → test-runner-debugger → project-documentation-writer → code-review)
- Optional: devils-advocate (1.5), user-documentation-writer (8), release (9)
- As-needed: explorer, refactor, qa-specialist, ui, ux, wisdom, supervisor, agent-audit

### test-runner-debugger References Non-Existent File

**Category:** Hook Accuracy
**Finding:** test-runner-debugger.md line 13 references "docs/testing/testing/TESTING_REGISTRY.md" (double "testing/" path)
**Impact:** Broken link - agents can't find the file
**Recommendation:** Fix path to "docs/testing/TESTING_REGISTRY.md"

---

## Low Priority Issues

### requirements-agent "Calculate Time/Cost" Repetition

**Category:** Creep Resistance
**Finding:** requirements-agent.md mentions "Never calculate time/cost estimates" in multiple places (lines 18, 123, 211, 253, 329)
**Impact:** None - this is actually good reinforcement, but could be consolidated
**Recommendation:** Keep the repetition - it's effective anchoring. Consider documenting this as a creep-resistance pattern in AGENT_STANDARDS.md

### Hook Prompt Length

**Category:** Hook Accuracy
**Finding:** Some hooks have very long prompts (e.g., forms hook is ~15 lines). While helpful, they may be skimmed.
**Impact:** Minimal - developers may not read full prompts
**Recommendation:** Consider condensing hook prompts to 3-5 key bullets, with "Read [DOC] for details"

### Agent Color Diversity

**Category:** Agent Structure
**Finding:** Agent colors in frontmatter are somewhat arbitrary and not documented
- green: brainstorming, requirements, ux
- red: devils-advocate, test-writer, release
- yellow: developer, test-runner-debugger
- blue: project-documentation-writer
- pink: code-review
- purple: user-documentation-writer, qa-specialist, wisdom
- cyan: explorer, ui
- orange: refactor, supervisor, agent-audit
**Impact:** None - colors are cosmetic in current implementation
**Recommendation:** Document color meanings if they're semantic, or note that they're aesthetic only

---

## Observations

### Excellent Creep Resistance Patterns

All agents demonstrate strong creep resistance:
- **Anchoring**: Every agent has "Your Core Identity" or "Your Core Purpose" section that grounds the agent
- **Boundary Statements**: Clear "You do NOT" and "You MUST" sections
- **Scope Limiters**: Explicit handoff points ("Next Agent: X")
- **Exit Criteria**: Clear completion signals (e.g., code-review-agent's verdict system)

**Examples of strong patterns:**
- requirements-agent: "YOU MUST NEVER: Write actual implementation code" (line 13-18)
- developer-agent: "YOU MUST NEVER BEGIN IMPLEMENTING UNTIL YOU HAVE CONFIRMED" (line 53)
- test-writer: "CRITICAL - Write Location: You MUST ONLY write test files to /tests/" (line 21-23)

### Agent Prompt Lengths

| Agent | Lines | Assessment |
|-------|-------|------------|
| wisdom-agent | 168 | Appropriately concise for conversational agent |
| agent-audit-agent | 213 | Good for meta-agent |
| brainstorming-agent | 275 | Balanced |
| devils-advocate-agent | 252 | Balanced |
| requirements-agent | 352 | Dense but appropriate for complex analytical task |
| developer-agent | 151 | Concise for execution agent |
| test-writer | 216 | Balanced |
| test-runner-debugger | 189 | Balanced |
| project-documentation-writer | 218 | Balanced |
| code-review-agent | 254 | Appropriate for comprehensive review task |
| user-documentation-writer | 253 | Balanced |
| explorer-agent | 389 | Longest - appropriate for discovery/analysis agent |
| refactor-agent | 507 | Very long - may need review |
| qa-specialist | 437 | Long but appropriate for multi-domain specialist |
| release-agent | 646 | Longest - extensive checklist-based agent |
| ui-agent | 436 | Long but appropriate for detailed audit |
| ux-agent | 457 | Long but appropriate for detailed audit |
| supervisor-agent | 714 | Very long - comprehensive health check agent |

**Total: 6,109 lines across 18 agents = ~340 lines average**

Outliers:
- supervisor-agent (714) and release-agent (646) are longest, but justified by comprehensive checklists
- refactor-agent (507) could potentially be streamlined

### Strong Hook Coverage

Settings.json PreToolUse hooks cover:
- Test operations (npm run test)
- Forms (Edit/Write **/*form*.tsx, **/*Form*.tsx)
- Pages (Edit **/page.tsx)
- List clients (Edit **/*-list-client.tsx)
- Migrations (Edit/Write **/migrations/*.sql)
- Server actions (Edit/Write src/lib/actions/*.ts)
- Tests (Edit/Write tests/*.spec.ts)
- Pickers (Edit src/components/pickers/*.tsx)
- Content builders (Edit/Write src/lib/content-builders/**/*.ts)
- Documentation (Edit/Write docs/**/*.md)

**Coverage Assessment: EXCELLENT**

Gaps identified:
- Validation files (see High Priority Issues)
- Component files (could add hooks for custom components)
- Constants files (could add hooks for src/lib/constants/*.ts)

### Documentation Cross-References

AGENT_WORKFLOWS.md (561 lines) provides excellent:
- Complete agent inventory with folder ownership
- Decision trees for "Which Agent Should I Use?"
- Standard 9-step workflow with phase descriptions
- Optional gates (brainstorming review, requirements review, multi-module pause)
- Smart loop-back patterns from code-review-agent
- Common scenarios with examples
- Quality gates per agent
- Best practices

CLAUDE.md "Required Reading by Task" table provides clear routing:
- 18 task categories mapped to required documentation
- Agent column specifies which agent to use
- All entries reference actual documentation files

**Alignment: STRONG** - Minor update needed for agent count

### Agent Folder Structure

All agents properly located in `.claude/agents/` with:
- Consistent `.md` extension
- Kebab-case filenames matching agent names
- Frontmatter with required fields (name, description, model, color)
- Examples in description field
- Clear section structure

**Structure: EXCELLENT**

---

## Recommendations Summary

### Immediate Actions (Critical)
1. **Merge and delete settings.local.json** - Settings hygiene issue that could cause configuration drift

### Short-term Actions (High Priority)
2. **Add picker hook coverage** - Protect picker patterns from drift
3. **Add validation hook coverage** - Protect validation patterns from drift
4. **Promote wisdom-agent visibility** - Add to Quick Decision Guide in CLAUDE.md
5. **Update agent count** - Fix AGENT_WORKFLOWS.md to reflect 18 agents

### Medium-term Actions (Medium Priority)
6. **Fix test-runner-debugger path** - Correct TESTING_REGISTRY.md path
7. **Clarify workflow numbering** - Standardize step numbering across agents
8. **Update brainstorming-agent handoff** - Mention devils-advocate-agent option

### Future Considerations (Low Priority)
9. **Review refactor-agent length** - Consider streamlining if possible
10. **Condense hook prompts** - Make them scannable (3-5 bullets)
11. **Document color system** - Clarify if colors are semantic or aesthetic

### Documentation Maintenance
12. **Create AGENT_STANDARDS.md** - Document baseline expectations for agent structure, creep resistance patterns, and boundary clarity
13. **Consider agent versioning** - Track significant changes to agent prompts over time

---

## Positive Patterns to Preserve

1. **Consistent "You do NOT" boundaries** - Every agent clearly states what's out of scope
2. **Strong anchoring statements** - "Your Core Identity" grounds agents effectively
3. **Clear handoff protocols** - Agents know when to pass work to others
4. **Comprehensive hook coverage** - Critical operations are well-protected
5. **Example-driven descriptions** - Agent frontmatter includes concrete usage examples
6. **Read-first requirements** - Agents are instructed to read docs before acting
7. **Quality checklists** - Most agents have verification checklists before completion
8. **Smart loop-back** - code-review-agent intelligently routes issues to appropriate agents

---

## Conclusion

The Outward Sign agent ecosystem demonstrates **mature design** with strong creep resistance, clear boundaries, and comprehensive coverage. This first audit establishes a healthy baseline.

**Overall Grade: A-** (Excellent with minor improvements needed)

**Primary Focus Areas:**
- Settings hygiene (critical)
- Hook coverage gaps (high priority)
- Documentation alignment (medium priority)

The ecosystem is production-ready and well-positioned for continued growth. Regular audits (quarterly or after major agent additions) are recommended to maintain quality.
